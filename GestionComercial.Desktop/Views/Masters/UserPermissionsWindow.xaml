<Window x:Class="GestionComercial.Desktop.Views.Masters.UserPermissionsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:GestionComercial.Desktop.Views.Masters"
        MinHeight="600"
        MinWidth="720"
        Height="600"
        Width="720"
        WindowStartupLocation="CenterScreen"
        Title="Permisos de usuario">
    <Grid>
        <Grid.ColumnDefinitions>
            <!-- Panel de Permisos -->
            <ColumnDefinition Width="auto" />
            <!-- Panel de Usuarios -->
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="400"/>
            <RowDefinition Height="60"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Panel de usuarios -->
        <DockPanel Grid.Row="0" Grid.Column="0" Background="#f5f5f5" Margin="10">
            <TextBlock Text="Usuarios"
                       FontWeight="Bold"
                       Margin="5"
                       HorizontalAlignment="Center" 
                       VerticalAlignment="Center"
                       Style="{StaticResource BlueBold16 }"/>
            <ListBox ItemsSource="{Binding Users}"
                     SelectedItem="{Binding SelectedUser, Mode=TwoWay}"
                     DisplayMemberPath="FullName"
                     MouseDoubleClick="ListBox_MouseDoubleClick"
                     Margin="5"/>
        </DockPanel>

        <!-- Panel de permisos -->
        <ScrollViewer Grid.Row="0" Grid.Column="1" Margin="10">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Encabezados con checkboxes generales -->
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Text="Módulo" FontWeight="Bold" Grid.Column="0" Margin="0,0,0,10"/>
                    <CheckBox Grid.Column="1" Content="Lectura" FontWeight="Bold" HorizontalAlignment="Center"
                      IsChecked="{Binding SelectAllRead, Mode=TwoWay}" />
                    <CheckBox Grid.Column="2" Content="Agregar" FontWeight="Bold" HorizontalAlignment="Center"
                      IsChecked="{Binding SelectAllAdd, Mode=TwoWay}" />
                    <CheckBox Grid.Column="3" Content="Editar" FontWeight="Bold" HorizontalAlignment="Center"
                      IsChecked="{Binding SelectAllEdit, Mode=TwoWay}" />
                    <CheckBox Grid.Column="4" Content="Borrar" FontWeight="Bold" HorizontalAlignment="Center"
                      IsChecked="{Binding SelectAllDelete, Mode=TwoWay}" />
                </Grid>

                <!-- Filas de permisos -->
                <ItemsControl Grid.Row="1" ItemsSource="{Binding PermissionGroups}" AlternationCount="2">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <!-- Border para el color de fondo alternado -->
                            <Border x:Name="RowBorder" Padding="2" Margin="2">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="2*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="{Binding ModuleName}" Grid.Column="0" VerticalAlignment="Center" Padding="4,2"/>
                                    <CheckBox IsChecked="{Binding CanRead, Mode=TwoWay}" Grid.Column="1" HorizontalAlignment="Center" IsEnabled="{Binding IsEnabledCanRead, Mode=TwoWay}"/>
                                    <CheckBox IsChecked="{Binding CanAdd, Mode=TwoWay}" Grid.Column="2" HorizontalAlignment="Center"/>
                                    <CheckBox IsChecked="{Binding CanEdit, Mode=TwoWay}" Grid.Column="3" HorizontalAlignment="Center"/>
                                    <CheckBox IsChecked="{Binding CanDelete, Mode=TwoWay}" Grid.Column="4" HorizontalAlignment="Center"/>
                                </Grid>

                                <!-- DataTrigger para alternar colores según el índice -->
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="White"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding (ItemsControl.AlternationIndex), RelativeSource={RelativeSource AncestorType=ContentPresenter}}" Value="1">
                                                <Setter Property="Background" Value="#FFF0F0F0"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </Grid>
        </ScrollViewer>


        <!-- Botones -->
        <Button x:Name="btnCancel"
                Grid.Row="1" 
                Grid.ColumnSpan="2" 
                Grid.Column="0"
                HorizontalAlignment="Center" 
                VerticalAlignment="Center"
                Content="Cerrar" 
                Margin="0,40,120,0" 
                Click="BtnCancel_Click"
                Style="{StaticResource BtnCancel}"/>
        <Button x:Name="btnUpdate"
                Grid.Row="1" 
                Grid.ColumnSpan="2" 
                Grid.Column="0"
                HorizontalAlignment="Center" 
                VerticalAlignment="Center"
                Content="Guardar" 
                Margin="120,40,0,0" 
                Click="BtnUpdate_Click"
                Style="{StaticResource BtnUpdate}"/>

        <!-- Mensajes -->
        <TextBlock x:Name="lblError"
                   Grid.Row="2" Grid.ColumnSpan="2"
                   HorizontalAlignment="Stretch"
                   Style="{StaticResource lblError12}"
                   TextWrapping="Wrap"
                   Padding="10,0,0,10"/>
        <TextBlock x:Name="lblConfirm"
                   Grid.Row="2" Grid.ColumnSpan="2"
                   HorizontalAlignment="Stretch"
                   Style="{StaticResource lblConfirm12}"
                   TextWrapping="Wrap"
                   Padding="10,0,0,10"/>
    </Grid>
</Window>
