<Window x:Class="GestionComercial.Desktop.Views.Sales.PayMethodWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Métodos de Pago"
        Height="450" Width="700"
        Loaded="PayMethodWin_Loaded"
        KeyDown="PayMethodWin_KeyDown">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <!-- DataGrid -->
            <RowDefinition Height="Auto"/>
            <!-- Totales -->
            <RowDefinition Height="Auto"/>
            <!-- Botones -->
        </Grid.RowDefinitions>

        <!-- DataGrid -->
        <DataGrid x:Name="dgMetodosPago"
                  ItemsSource="{Binding MetodosPago}"
                  AutoGenerateColumns="False"
                  CellEditEnding="dgMetodosPago_CellEditEnding"
                  PreparingCellForEdit="dgMetodosPago_PreparingCellForEdit"
                  CanUserAddRows="True"
                  Margin="0,0,0,5"
                  Grid.Row="0">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Método"
                                    Binding="{Binding MetodoCodigo, UpdateSourceTrigger=PropertyChanged}"
                                    Width="100"/>

                <DataGridTextColumn Header="Descripción"
                                    Binding="{Binding MetodoDescripcion}"
                                    IsReadOnly="True"
                                    Width="*"/>

                <DataGridTextColumn Header="Monto"
                                    Binding="{Binding Monto,UpdateSourceTrigger=LostFocus, Converter={StaticResource TwoDecimalMoneyCommaConverter}}"
                                    Width="150">
                    <!--<DataGridTextColumn.EditingElementStyle>
                        <Style TargetType="TextBox">
                            <EventSetter Event="GotFocus" Handler="Monto_GotFocus"/>
                            <EventSetter Event="PreviewKeyDown" Handler="Monto_PreviewKeyDown"/>
                            <EventSetter Event="PreviewTextInput" Handler="Monto_PreviewTextInput"/>
                            <EventSetter Event="TextChanged" Handler="Monto_TextChanged"/>
                            --><!-- NO EventSetter para Pasting; se asocia en PreparingCellForEdit --><!--
                        </Style>
                    </DataGridTextColumn.EditingElementStyle>-->
                </DataGridTextColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Totales -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Grid.Row="1" Margin="0,5,0,5">
            <TextBlock Text="Total Venta:" 
                       Style="{StaticResource BlueBold14}"
                       Margin="0,0,8,0"/>
            <TextBlock Text="{Binding TotalVenta, StringFormat=C}" 
                       Style="{StaticResource BlackBold14}"
                       Margin="0,0,16,0"/>

            <TextBlock Text="Ingresado:" 
                       Style="{StaticResource BlueBold12}" 
                       Margin="0,0,8,0"/>
            <TextBlock Text="{Binding TotalIngresado, StringFormat=C}"
                       Style="{StaticResource BlackBold12}"                       
                       Margin="0,0,16,0"/>

            <TextBlock Text="Saldo:" 
                       Style="{StaticResource BlackBold12}"
                       Margin="0,0,8,0"/>
            <TextBlock Text="{Binding Saldo, StringFormat=C}" 
                       Style="{StaticResource BlackBold12}"
                       Margin="0,0,16,0"/>
        </StackPanel>

        <!-- Botones -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Grid.Row="2" Margin="0,5,0,0">
            <Button Content="Aceptar (F2)" 
                    Width="100" 
                    Margin="5" 
                    Click="Aceptar_Click"                    
                    Style="{StaticResource BtnAdd}"/>
            <Button Content="Cancelar (ESC)" 
                    Width="100" 
                    Margin="5" 
                    Click="Cancelar_Click"                    
                    Style="{StaticResource BtnCancel}"/>
        </StackPanel>
    </Grid>
</Window>
